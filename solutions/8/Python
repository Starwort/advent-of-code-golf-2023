import math
M,*I=open(0)
S={l[:3]:[l[7:10],l[12:15]]for l in I}
def f(s):
 a=[]
 for p in filter(lambda x:x[-s:]=="A"*s,S.keys()):
  c=0
  while p[-s:]!="Z"*s:p=S[p][M[c%(len(M)-1)]=="R"];c+=1
  a+=[c]
 return math.lcm(*a)
print(f(3),f(1))