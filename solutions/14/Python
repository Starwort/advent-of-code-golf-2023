*I,=open(c:=0)
R=range(100)
D={}
S=lambda:print(sum((100-y)*I[y].count('O')for y in R))
while c<1e9:
 for d in R[:4]:
  *I,=map(list,I)
  for x in R:
   p=0
   for y in R:p=[p,y]['.'>(C:=I[y][x])];I[y][x]='#.'[y>p];I[p][x]=C;p+=C!='.'
  c<1>d==S();*I,=zip(*I[::-1])
 d=c-D.get(s:=str(I),-1e9)+1;c+=(1e9-c)//d*d+1;D[s]=c
S()