*I,=open(c:=0)
R=range(100)
D={}
S=lambda:print(sum((100-y)*I[y].count('O')for y in R))
while c<1e9:
 for d in 0,1,2,3:
  *I,=map(list,I)
  for x in R:
   p=0
   for y in R:
    if'.'<(C:=I[y][x]):I[y][x]='.';I[p][x]='O';p+=1
    if'.'>C:p=y+1
  c<1>d==S();*I,=zip(*I[::-1])
 d=c-D.get(s:=str(I),-1e9)+1;c+=(1e9-c)//d*d+1;D[s]=c
S()