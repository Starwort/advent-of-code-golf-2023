from functools import*
f=cache(lambda s,l,b=1:(s.find(b*'.')>=l[0]and f(s[l[0]:],l[1:],0))+(s[0]>'#'and f(s[1:],l))if(l and s)else s>'#'not in s)
L=*open(0),
for k in 1,5:print(sum(f('?'.join([(z:=r.split())[0]]*k)+'.',eval(z[1])*k)for r in L))