M[t=substr($1,2)]=gsub(/,/,z)$0{for(;v=$++j;N[v]++)I[v]=I[v]0t
}END{for(L=I[x];L;i-1e3||A=C[0]*C[B=1]){$0=H<T?Q[++H]:s" "!++i
f=$3;C[p=$2]++;$0=M[t=$1];B*=i^sub(p t,z,L);p=/&/?sub(f".?|$",
f p,c[t])*gsub(1,1,c[t])<N[t]:/.%./?p?$0=z:++m[t]%2:p;for(j=2;
v=$++j;)Q[++T]=v" "p" "t}print A"\n"B}/roadca/{s=t}j=/rx/{x=t}