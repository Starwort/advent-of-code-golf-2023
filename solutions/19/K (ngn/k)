(W;P):(0,e)_i_e:*<i:0:0
W:!/+{(`$;{(`p;`$)@'$[~^x?":";":"\x;("1>0";x)]}'","\-1_)@'"{"\x}'W,("A{A}";"R{R}")
+//(`A={{t@*&,/.'c^'''x@*(c;t):+W@y}[x;]/`in}')#{!/``I$'+"="\'","\x^"{}"}'P
S:{(c;v;t):y;$[^j:`x`m`a`s?*v;,x;c|:/(1 0,'j)(.[x;;:;])'(t-~c;t+c:(>)~c)]}
{$[`A=y;*/0|1--/x;`R=y;0;+/((,x){(-1_x),S[*|x]y}/*r)o'*|r:+W@y]}[4#'1 4000;`in]