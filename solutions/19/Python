import re
B=C=0
I,*Q={},('in',[1,4001]*4)
F=re.findall
Y=[[*map(int,F('\d+',l))]for l in open(0)if' '<l for n,I[n]in[l.split('{')]if' '>n]
for p,L in Q:
 'B'>p==exec(f"C+={'(%d-%d)*'*4%(*L,)}1\nfor x in Y:i=-1;B+=sum(x)*all(L[i+1]<=v<L[i:=i+2]for v in x)")
 for z,R in F('(.\W\w+)?:?(\w+)',I.get(p,'')):Q+=(R,K:=L*1),;exec(z and'l=ord(z[0])//3%5*2^(">"in z);L[l]=K[l^1]=l%2+'+z[2:])
print(B,C)