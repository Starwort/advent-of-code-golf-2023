B=C=S=0
I={}
T,E,F,*Q=str.split,eval,exec,('in',*[1,4000]*4)
for l in open(0):S|=' '>l;' '<l!=F(["n,r=T(l[:-2],'{');I[n]=*map(T,T(r,','),':'*4),","p='in';F(l[1:~(l[-2]>'|')].replace(*',;'))\nwhile'Z'<p:q=0;[p:=r[q:=-1]for r in I[p]if-~q&(len(r)<2or E(r[0]))];B+=p<'B'and x+m+a+s"][S])
for p,x,X,m,M,a,A,s,S in Q:C+=~(X-x)*~(M-m)*~(A-a)*~(S-s)*(p<"B");p in I!=F('for*r,R in I[p]:Q+=E("R,x,X,m,M,a,A,s,S".replace(*(len(r)<1)*"~~"or([L:=r[0][0],U:=L.upper()][o:="<"in r[0]],f"{(n:=E(r[0][2:]))-o-~-o}"))),;F([U,L][o]+f"={n}")')
print(B,C)