g = $<.map &:chomp
solve = -> space {
    inds = g.size.times
    rows = inds.map{|y| g[y].chars.all?(".") ? space : 1 }
    cols = inds.map{|x| g.all?{_1[x] == "."} ? space : 1 }

    coords = []

    inds.each{|y|
        inds.each{|x|
            coords << [x,y] if g[y][x] == "#"
        }
    }

    coords.combination(2).sum{|(x1,y1),(x2,y2)|
        x = x1, x2
        y = y1, y2
        cols[x.min...x.max].sum + rows[y.min...y.max].sum
    }
}
p solve.(2), solve.(1000000)