s,*I=open(0)
S=s.split()
for P in 0,1:
 v=[[int(S[i]),(1,int(S[i+P]))[P]]for i in range(1,21,P+1)];n=[]
 for l in I:
  if"">l:v+=n;n=[]
  elif":">l[-2]:
   b,a,z=map(int,l.split());o=v;v=[]
   for f,l in o:A=a+z;N,V=[[[],[[f,l]]],[[[b,l-a+f]],[P:=[f,a-f]]],[[[f-a+b,A-f]],[Q:=[A,f+l-A]]],[[[f-a+b,l]],[]],[[[b,z]],[P,Q]]][4*(a>f<f+l>A)+2*(a<=f<A)+(a<f+l<=A)];n+=N;v+=V
 print(min(v+n)[0])