s,*I=open(0)
*S,=map(int,s.split()[1:])
for P in 0,1:
 v=[*zip(S[::P+1],[x*P for x in S[P::P+1]])];n=[]
 for l in I:
  if"">l:v+=n;n=[]
  elif":">l[-2]:
   b,a,z=map(int,l.split());o=v;v=[]
   for f,l in o:F=f+l;N,V=[[[[b,z]],[P:=[f,a-f],Q:=[A:=a+z,F-A]]],[[],[[f,l]]],[[[b,F-a]],[P]],[[[f-a+b,A-f]],[Q]],[[[f-a+b,l]],[]]][1-(a>f<F>A)+2*(a<=f<A)+(a<F<=A)];n+=N;v+=V
 print(min(v+n)[0])