S,*I=[[int(x)for x in l.split()if":">x]for l in open(0)]
for P in 0,1:
 *d,=zip(S[::P+1],map(P.__mul__,S[P::P+1]));n=[]
 for l in I:
  if l:
   b,a,s,e,*d=*l,d
   for f,l in e:N,D=[[[b,s]],[],[[b,(F:=f+l-(A:=a+s))+s]],[[g:=f-a+b,A-f]],[[g,l]],[P:=[f,a-f],Q:=[A,F]],[[f,l]],[P],[Q],[]][1-(a>f>0<F)+2*(a<=f<A)+(-s<F<1)::5];n+=N;d+=D
  else:d+=n;n=[]
 print(min(d+n)[0])