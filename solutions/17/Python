from heapq import*
g=open(0).read()
for j in 1,2:
 *q,v=(0,0,1),(0,0,k:=142),{0}
 while q:
  c,p,d=heappop(q)
  if{t:=(p,d)}-v:
   for D in-k//d,k//d:
    for i in range(j*j,j**3+3):len(S:=g[p::D][1:i+1])==i!=heappush(q,(c+sum((ord(x)-48)%999for x in S),p+D*i,D));v|={t}
  if p>20019:print(c);q=0