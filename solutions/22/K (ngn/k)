n:x
{n,:,?{y@&x=M::|/x}.x[;Y:10/+/2#'y];x[;Y]:|z,M+1+0//y;x}/[2 100#N;B@:<0/'*'B;R:!N:#B:{(!1--)\+{x@<x}'+.'"~"\x}'0:0];1+N-#?,/n@&1=#'n
-N-/#'R{(-|/^x?n@y)_x,:y}/\:R